---
sidebar: sidebar 
permalink: vmware/vmw-gcp-gcve-guest-storage.html 
keywords: NetApp Solutions, google cloud, gcp, gcve, enterprise, hybrid, cloud, cloud volumes ontap, cvo 
summary:  
---
= Opções de armazenamento NetApp para GCP
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
O GCP oferece suporte ao armazenamento NetApp conectado a convidados com o Cloud Volumes ONTAP (CVO) ou o Google Cloud NetApp Volumes (NetApp Volumes).



== Cloud Volumes ONTAP (CVO)

O Cloud Volumes ONTAP, ou CVO, é a solução de gerenciamento de dados em nuvem líder do setor, desenvolvida no software de armazenamento ONTAP da NetApp, disponível nativamente na Amazon Web Services (AWS), Microsoft Azure e Google Cloud Platform (GCP).

É uma versão definida por software do ONTAP que consome armazenamento nativo da nuvem, permitindo que você tenha o mesmo software de armazenamento na nuvem e no local, reduzindo a necessidade de treinar novamente sua equipe de TI em métodos totalmente novos para gerenciar seus dados.

O CVO oferece aos clientes a capacidade de mover dados facilmente da borda para o data center, para a nuvem e vice-versa, reunindo sua nuvem híbrida — tudo gerenciado com um console de gerenciamento de painel único, o NetApp Cloud Manager.

Por design, o CVO oferece desempenho extremo e recursos avançados de gerenciamento de dados para satisfazer até mesmo seus aplicativos mais exigentes na nuvem



=== Cloud Volumes ONTAP (CVO) como armazenamento conectado a convidados

.Implantar o Cloud Volumes ONTAP no Google Cloud (faça você mesmo)
[%collapsible%open]
====
Os compartilhamentos Cloud Volumes ONTAP podem ser montados a partir de VMs criadas no ambiente de nuvem privada do GCVE.  Os volumes também podem ser montados no cliente Linux e no cliente Windows, e os LUNS podem ser acessados em clientes Linux ou Windows como dispositivos de bloco quando montados sobre iSCSI, porque o Cloud Volumes ONTAP oferece suporte aos protocolos iSCSI, SMB e NFS.  Os volumes Cloud Volumes ONTAP podem ser configurados em algumas etapas simples.

Para replicar volumes de um ambiente local para a nuvem para fins de recuperação de desastres ou migração, estabeleça conectividade de rede com o Google Cloud, usando uma VPN site a site ou o Cloud Interconnect.  A replicação de dados locais para o Cloud Volumes ONTAP está fora do escopo deste documento.  Para replicar dados entre sistemas locais e Cloud Volumes ONTAP , consultelink:mailto:CloudOwner@gve.local#setting-up-data-replication-between-systems["Configurando a replicação de dados entre sistemas"] .


NOTE: Usarlink:https://cloud.netapp.com/cvo-sizer["Dimensionador Cloud Volumes ONTAP"] para dimensionar com precisão as instâncias do Cloud Volumes ONTAP .  Monitore também o desempenho local para usar como entradas no dimensionador Cloud Volumes ONTAP .

. Efetue login no NetApp Cloud Central — a tela Fabric View é exibida.  Localize a guia Cloud Volumes ONTAP e selecione Ir para o Cloud Manager.  Após efetuar login, a tela Canvas será exibida.
+
image:gcve-cvo-guest-001.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Na guia Cloud Manager Canvas, clique em Adicionar um ambiente de trabalho e selecione Google Cloud Platform como a nuvem e o tipo de configuração do sistema.  Em seguida, clique em Avançar.
+
image:gcve-cvo-guest-002.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Forneça os detalhes do ambiente a ser criado, incluindo o nome do ambiente e as credenciais do administrador.  Após terminar, clique em Continuar.
+
image:gcve-cvo-guest-003.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Selecione ou desmarque os serviços complementares para implantação do Cloud Volumes ONTAP , incluindo Data Sense & Compliance ou Backup to Cloud.  Em seguida, clique em Continuar.
+
DICA: Uma mensagem pop-up de verificação será exibida ao desativar serviços complementares.  Serviços complementares podem ser adicionados/removidos após a implantação do CVO. Considere desmarcá-los se não forem necessários desde o início para evitar custos.

+
image:gcve-cvo-guest-004.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Selecione um local, escolha uma política de firewall e marque a caixa de seleção para confirmar a conectividade de rede com o armazenamento do Google Cloud.
+
image:gcve-cvo-guest-005.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Selecione a opção de licença: Pague conforme o uso ou BYOL para usar a licença existente.  Neste exemplo, a opção Freemium é usada.  Em seguida, clique em Continuar.
+
image:gcve-cvo-guest-006.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Selecione entre vários pacotes pré-configurados disponíveis com base no tipo de carga de trabalho que será implantada nas VMs em execução na nuvem VMware no AWS SDDC.
+
DICA: Passe o mouse sobre os blocos para obter detalhes ou personalize os componentes do CVO e a versão do ONTAP clicando em Alterar configuração.

+
image:gcve-cvo-guest-007.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Na página Revisar e aprovar, revise e confirme as seleções. Para criar a instância do Cloud Volumes ONTAP , clique em Ir.
+
image:gcve-cvo-guest-008.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Depois que o Cloud Volumes ONTAP é provisionado, ele é listado nos ambientes de trabalho na página Canvas.
+
image:gcve-cvo-guest-009.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]



====
.Configurações adicionais para volumes SMB
[%collapsible%open]
====
. Depois que o ambiente de trabalho estiver pronto, certifique-se de que o servidor CIFS esteja configurado com os parâmetros de configuração de DNS e Active Directory apropriados.  Esta etapa é necessária antes que você possa criar o volume SMB.
+
DICA: Clique no ícone Menu (º), selecione Avançado para exibir mais opções e selecione Configuração CIFS.

+
image:gcve-cvo-guest-010.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Criar o volume SMB é um processo fácil.  No Canvas, clique duas vezes no ambiente de trabalho Cloud Volumes ONTAP para criar e gerenciar volumes e clique na opção Criar Volume.  Escolha o tamanho apropriado e o gerenciador de nuvem escolhe o agregado que o contém ou usa o mecanismo de alocação avançado para colocar em um agregado específico.  Para esta demonstração, CIFS/SMB foi selecionado como protocolo.
+
image:gcve-cvo-guest-011.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Depois que o volume for provisionado, ele ficará disponível no painel Volumes.  Como um compartilhamento CIFS é provisionado, conceda aos seus usuários ou grupos permissão para os arquivos e pastas e verifique se esses usuários podem acessar o compartilhamento e criar um arquivo.  Esta etapa não é necessária se o volume for replicado de um ambiente local porque as permissões de arquivo e pasta são todas mantidas como parte da replicação do SnapMirror .
+
DICA: Clique no menu de volume (º) para exibir suas opções.

+
image:gcve-cvo-guest-012.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Após a criação do volume, use o comando mount para exibir as instruções de conexão do volume e, em seguida, conecte-se ao compartilhamento a partir das VMs no Google Cloud VMware Engine.
+
image:gcve-cvo-guest-013.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Copie o caminho a seguir e use a opção Mapear unidade de rede para montar o volume na VM em execução no Google Cloud VMware Engine.
+
image:gcve-cvo-guest-014.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

+
Uma vez mapeado, ele pode ser acessado facilmente, e as permissões NTFS podem ser definidas adequadamente.

+
image:gcve-cvo-guest-015.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]



====
.Conecte o LUN no Cloud Volumes ONTAP a um host
[%collapsible%open]
====
Para conectar o LUN ONTAP dos volumes de nuvem a um host, conclua as seguintes etapas:

. Na página Canvas, clique duas vezes no ambiente de trabalho Cloud Volumes ONTAP para criar e gerenciar volumes.
. Clique em Adicionar volume > Novo volume, selecione iSCSI e clique em Criar grupo de iniciadores.  Clique em Continuar.
+
image:gcve-cvo-guest-016.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"] image:gcve-cvo-guest-017.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Após o provisionamento do volume, selecione o menu de volume (º) e clique em Target iQN.  Para copiar o Nome Qualificado iSCSI (iQN), clique em Copiar.  Configure uma conexão iSCSI do host para o LUN.


Para fazer o mesmo para o host residente no Google Cloud VMware Engine:

. RDP para a VM hospedada no Google Cloud VMware Engine.
. Abra a caixa de diálogo Propriedades do Iniciador iSCSI: Gerenciador do Servidor > Painel > Ferramentas > Iniciador iSCSI.
. Na guia Descoberta, clique em Descobrir Portal ou Adicionar Portal e insira o endereço IP da porta de destino iSCSI.
. Na guia Destinos, selecione o alvo descoberto e clique em Fazer logon ou Conectar.
. Selecione Habilitar multicaminho e, em seguida, selecione Restaurar automaticamente esta conexão quando o computador iniciar ou Adicionar esta conexão à lista de destinos favoritos.  Clique em Avançado.
+

NOTE: O host do Windows deve ter uma conexão iSCSI com cada nó no cluster.  O DSM nativo seleciona os melhores caminhos a serem usados.

+
image:gcve-cvo-guest-018.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

+
LUNs na máquina virtual de armazenamento (SVM) aparecem como discos para o host Windows.  Nenhum novo disco adicionado é descoberto automaticamente pelo host.  Inicie uma nova verificação manual para descobrir os discos concluindo as seguintes etapas:

+
.. Abra o utilitário Gerenciamento do Computador do Windows: Iniciar > Ferramentas Administrativas > Gerenciamento do Computador.
.. Expanda o nó Armazenamento na árvore de navegação.
.. Clique em Gerenciamento de disco.
.. Clique em Ação > Reexaminar discos.
+
image:gcve-cvo-guest-019.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

+
Quando um novo LUN é acessado pela primeira vez pelo host Windows, ele não tem partição ou sistema de arquivos.  Inicialize o LUN e, opcionalmente, formate o LUN com um sistema de arquivos concluindo as seguintes etapas:

.. Inicie o Gerenciamento de Disco do Windows.
.. Clique com o botão direito do mouse no LUN e selecione o tipo de disco ou partição desejado.
.. Siga as instruções do assistente.  Neste exemplo, a unidade F: está montada.




image:gcve-cvo-guest-020.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

Nos clientes Linux, certifique-se de que o daemon iSCSI esteja em execução.  Depois que os LUNs forem provisionados, consulte as orientações detalhadas sobre configuração de iSCSI com o Ubuntu como exemplo aqui.  Para verificar, execute lsblk cmd no shell.

image:gcve-cvo-guest-021.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"] image:gcve-cvo-guest-022.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

====
.Montar Cloud Volumes ONTAP Volumes no cliente Linux
[%collapsible%open]
====
Para montar o sistema de arquivos Cloud Volumes ONTAP (DIY) de VMs no Google Cloud VMware Engine, siga as etapas abaixo:

Provisione o volume seguindo as etapas abaixo

. Na guia Volumes, clique em Criar novo volume.
. Na página Criar novo volume, selecione um tipo de volume:
+
image:gcve-cvo-guest-023.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Na aba Volumes, coloque o cursor do mouse sobre o volume, selecione o ícone de menu (º) e clique em Montar Comando.
+
image:gcve-cvo-guest-024.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Clique em Copiar.
. Conecte-se à instância Linux designada.
. Abra um terminal na instância usando shell seguro (SSH) e faça login com as credenciais apropriadas.
. Crie um diretório para o ponto de montagem do volume com o seguinte comando.
+
 $ sudo mkdir /cvogcvetst
+
image:gcve-cvo-guest-025.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Monte o volume NFS do Cloud Volumes ONTAP no diretório criado na etapa anterior.
+
 sudo mount 10.0.6.251:/cvogcvenfsvol01 /cvogcvetst
+
image:gcve-cvo-guest-026.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"] image:gcve-cvo-guest-027.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]



====


== Google Cloud NetApp Volumes (Volumes NetApp )

O Google Cloud NetApp Volumes (NetApp Volumes) é um portfólio completo de serviços de dados para fornecer soluções avançadas em nuvem.  O NetApp Volumes oferece suporte a vários protocolos de acesso a arquivos para os principais provedores de nuvem (suporte a NFS e SMB).

Outros benefícios e recursos incluem: proteção e restauração de dados com Snapshot; recursos especiais para replicar, sincronizar e migrar destinos de dados no local ou na nuvem; e alto desempenho consistente no nível de um sistema de armazenamento flash dedicado.



=== Google Cloud NetApp Volumes (NetApp Volumes) como armazenamento conectado a convidados

.Configurar volumes NetApp com o VMware Engine
[%collapsible%open]
====
Os compartilhamentos do Google Cloud NetApp Volumes podem ser montados a partir de VMs criadas no ambiente do VMware Engine.  Os volumes também podem ser montados no cliente Linux e mapeados no cliente Windows porque o Google Cloud NetApp Volumes oferece suporte aos protocolos SMB e NFS.  Os volumes do Google Cloud NetApp Volumes podem ser configurados em etapas simples.

O Google Cloud NetApp Volumes e a nuvem privada do Google Cloud VMware Engine devem estar na mesma região.

Para comprar, habilitar e configurar o Google Cloud NetApp Volumes para Google Cloud no Google Cloud Marketplace, siga estas instruções detalhadaslink:https://cloud.google.com/vmware-engine/docs/quickstart-prerequisites["guia"] .

====
.Crie um volume NFS do NetApp Volumes para a nuvem privada GCVE
[%collapsible%open]
====
Para criar e montar volumes NFS, conclua as seguintes etapas:

. Acesse o Cloud Volumes a partir das Soluções de Parceiros no console do Google Cloud.
+
image:gcve-cvs-guest-001.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. No Console do Cloud Volumes, acesse a página Volumes e clique em Criar.
+
image:gcve-cvs-guest-002.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Na página Criar sistema de arquivos, especifique o nome do volume e os rótulos de cobrança, conforme necessário para mecanismos de estorno.
+
image:gcve-cvs-guest-003.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Selecione o serviço apropriado.  Para GCVE, escolha NetApp Volumes-Desempenho e nível de serviço desejado para melhor latência e maior desempenho com base nos requisitos de carga de trabalho do aplicativo.
+
image:gcve-cvs-guest-004.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Especifique a região do Google Cloud para o volume e o caminho do volume (o caminho do volume deve ser exclusivo em todos os volumes de nuvem no projeto)
+
image:gcve-cvs-guest-005.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Selecione o nível de desempenho para o volume.
+
image:gcve-cvs-guest-006.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Especifique o tamanho do volume e o tipo de protocolo.  Neste teste, o NFSv3 é usado.
+
image:gcve-cvs-guest-007.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Nesta etapa, selecione a rede VPC da qual o volume estará acessível.  Certifique-se de que o peering de VPC esteja em vigor.
+
DICA: Se o peering de VPC não tiver sido feito, um botão pop-up será exibido para guiá-lo pelos comandos de peering.  Abra uma sessão do Cloud Shell e execute os comandos apropriados para parear sua VPC com o produtor do Google Cloud NetApp Volumes .  Caso você decida preparar o peering de VPC com antecedência, consulte estas instruções.

+
image:gcve-cvs-guest-008.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Gerencie as regras da política de exportação adicionando as regras apropriadas e marque a caixa de seleção para a versão do NFS correspondente.
+
Observação: o acesso aos volumes NFS não será possível a menos que uma política de exportação seja adicionada.

+
image:gcve-cvs-guest-009.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Clique em Salvar para criar o volume.
+
image:gcve-cvs-guest-010.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]



====
.Montando exportações NFS para VMs em execução no VMware Engine
[%collapsible%open]
====
Antes de preparar a montagem do volume NFS, certifique-se de que o status de peering da conexão privada esteja listado como Ativo.  Quando o status for Ativo, use o comando mount.

Para montar um volume NFS, faça o seguinte:

. No Cloud Console, acesse Cloud Volumes > Volumes.
. Vá para a página de volumes
. Clique no volume NFS para o qual você deseja montar exportações NFS.
. Role para a direita, em Mostrar mais, clique em Instruções de montagem.


Para executar o processo de montagem no sistema operacional convidado da VM VMware, siga as etapas abaixo:

. Use o cliente SSH e SSH para a máquina virtual.
. Instale o cliente nfs na instância.
+
.. Na instância do Red Hat Enterprise Linux ou SuSE Linux:
+
 sudo yum install -y nfs-utils
.. Em uma instância Ubuntu ou Debian:
+
 sudo apt-get install nfs-common


. Crie um novo diretório na instância, como "/nimCVSNFSol01":
+
 sudo mkdir /nimCVSNFSol01
+
image:gcve-cvs-guest-020.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Monte o volume usando o comando apropriado.  Exemplo de comando do laboratório abaixo:
+
 sudo mount -t nfs -o rw,hard,rsize=65536,wsize=65536,vers=3,tcp 10.53.0.4:/nimCVSNFSol01 /nimCVSNFSol01
+
image:gcve-cvs-guest-021.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"] image:gcve-cvs-guest-022.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]



====
.Criação e montagem de compartilhamento SMB em VMs em execução no VMware Engine
[%collapsible%open]
====
Para volumes SMB, certifique-se de que as conexões do Active Directory estejam configuradas antes de criar o volume SMB.

image:gcve-cvs-guest-030.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

Depois que a conexão do AD estiver estabelecida, crie o volume com o nível de serviço desejado.  As etapas são como a criação de um volume NFS, exceto pela seleção do protocolo apropriado.

. No Console do Cloud Volumes, acesse a página Volumes e clique em Criar.
. Na página Criar sistema de arquivos, especifique o nome do volume e os rótulos de cobrança, conforme necessário para mecanismos de estorno.
+
image:gcve-cvs-guest-031.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Selecione o serviço apropriado.  Para GCVE, escolha NetApp Volumes-Desempenho e nível de serviço desejado para melhor latência e maior desempenho com base nos requisitos de carga de trabalho.
+
image:gcve-cvs-guest-032.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Especifique a região do Google Cloud para o volume e o caminho do volume (o caminho do volume deve ser exclusivo em todos os volumes de nuvem no projeto)
+
image:gcve-cvs-guest-033.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Selecione o nível de desempenho para o volume.
+
image:gcve-cvs-guest-034.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Especifique o tamanho do volume e o tipo de protocolo.  Neste teste, o SMB é usado.
+
image:gcve-cvs-guest-035.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Nesta etapa, selecione a rede VPC da qual o volume estará acessível.  Certifique-se de que o peering de VPC esteja em vigor.
+
DICA: Se o peering de VPC não tiver sido feito, um botão pop-up será exibido para guiá-lo pelos comandos de peering.  Abra uma sessão do Cloud Shell e execute os comandos apropriados para parear sua VPC com o produtor do Google Cloud NetApp Volumes .  Caso você decida preparar o peering de VPC com antecedência, consulte esteslink:https://cloud.google.com/architecture/partners/netapp-cloud-volumes/setting-up-private-services-access?hl=en["instruções"] .

+
image:gcve-cvs-guest-036.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

. Clique em Salvar para criar o volume.
+
image:gcve-cvs-guest-037.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]



Para montar o volume SMB, faça o seguinte:

. No Cloud Console, acesse Cloud Volumes > Volumes.
. Vá para a página de volumes
. Clique no volume SMB para o qual você deseja mapear um compartilhamento SMB.
. Role para a direita, em Mostrar mais, clique em Instruções de montagem.


Para executar o processo de montagem no sistema operacional convidado Windows da VM VMware, siga as etapas abaixo:

. Clique no botão Iniciar e depois em Computador.
. Clique em Mapear unidade de rede.
. Na lista Unidades, clique em qualquer letra de unidade disponível.
. Na caixa de pasta, digite:
+
 \\nimsmb-3830.nimgcveval.com\nimCVSMBvol01
+
image:gcve-cvs-guest-038.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]

+
Para conectar-se sempre que fizer login no seu computador, marque a caixa de seleção Reconectar ao fazer login.

. Clique em Concluir.
+
image:gcve-cvs-guest-039.png["Figura mostrando diálogo de entrada/saída ou representando conteúdo escrito"]



====